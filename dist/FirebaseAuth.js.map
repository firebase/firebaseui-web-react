{"version":3,"file":"FirebaseAuth.js","names":["FirebaseAuth","props","uiConfig","firebaseAuth","className","uiCallback","firebaseui","setFirebaseui","userSignedIn","setUserSignedIn","elementRef","require","firebaseUiWidget","auth","AuthUI","getInstance","signInFlow","reset","unregisterAuthObserver","user","start","current"],"sources":["../src/FirebaseAuth.jsx"],"sourcesContent":["/**\n * Copyright 2017 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// @flow\n\nimport React, { useEffect, useRef, useState } from 'react';\nimport { onAuthStateChanged } from 'firebase/auth';\n\n/**\n * React wrapper for the FirebaseUI Auth widget.\n */\nconst FirebaseAuth = (props) => {\n  const {\n    uiConfig,\n    firebaseAuth,\n    className,\n    uiCallback,\n  } = props;\n\n  const [firebaseui, setFirebaseui] = useState(null);\n  const [userSignedIn, setUserSignedIn] = useState(false);\n\n  const elementRef = useRef(null);\n\n  useEffect(() => {\n    // Firebase UI only works on the Client. So we're loading the package only after\n    // the component has mounted, so that this works when doing server-side rendering.\n    setFirebaseui(require('firebaseui'));\n  }, []);\n\n  useEffect(() => {\n    if (firebaseui === null) {\n      return;\n    }\n\n    // Get or Create a firebaseUI instance.\n    const firebaseUiWidget =\n      firebaseui.auth.AuthUI.getInstance() ||\n      new firebaseui.auth.AuthUI(firebaseAuth);\n  \n    if (uiConfig.signInFlow === 'popup') {\n      firebaseUiWidget.reset();\n    }\n\n    // We track the auth state to reset firebaseUi if the user signs out.\n    const unregisterAuthObserver = onAuthStateChanged(firebaseAuth, (user) => {\n      if (!user && userSignedIn) {\n        firebaseUiWidget.reset();\n      }\n      setUserSignedIn(!!user);\n    });\n\n    // Trigger the callback if any was set.\n    if (uiCallback) {\n      uiCallback(firebaseUiWidget);\n    }\n\n    // Render the firebaseUi Widget.\n    firebaseUiWidget.start(elementRef.current, uiConfig);\n\n    return () => {\n      unregisterAuthObserver();\n      firebaseUiWidget.reset();\n    };\n  }, [firebaseui, uiConfig]);\n\n  if (firebaseui !== null) {\n    // Import the css only on the client.\n    require('firebaseui/dist/firebaseui.css');\n  }\n\n  return (\n    <div className={className} ref={elementRef} />\n  );\n};\n\nexport default FirebaseAuth;\n"],"mappings":";;;;;;;;;AAiBA;;AACA;;;;;;;;;;;;;;;;;;AAKA,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;EAC9B,IACEC,QADF,GAKID,KALJ,CACEC,QADF;EAAA,IAEEC,YAFF,GAKIF,KALJ,CAEEE,YAFF;EAAA,IAGEC,SAHF,GAKIH,KALJ,CAGEG,SAHF;EAAA,IAIEC,UAJF,GAKIJ,KALJ,CAIEI,UAJF;;EAOA,gBAAoC,qBAAS,IAAT,CAApC;EAAA;EAAA,IAAOC,UAAP;EAAA,IAAmBC,aAAnB;;EACA,iBAAwC,qBAAS,KAAT,CAAxC;EAAA;EAAA,IAAOC,YAAP;EAAA,IAAqBC,eAArB;;EAEA,IAAMC,UAAU,GAAG,mBAAO,IAAP,CAAnB;EAEA,sBAAU,YAAM;IAGdH,aAAa,CAACI,OAAO,CAAC,YAAD,CAAR,CAAb;EACD,CAJD,EAIG,EAJH;EAMA,sBAAU,YAAM;IACd,IAAIL,UAAU,KAAK,IAAnB,EAAyB;MACvB;IACD;;IAGD,IAAMM,gBAAgB,GACpBN,UAAU,CAACO,IAAX,CAAgBC,MAAhB,CAAuBC,WAAvB,MACA,IAAIT,UAAU,CAACO,IAAX,CAAgBC,MAApB,CAA2BX,YAA3B,CAFF;;IAIA,IAAID,QAAQ,CAACc,UAAT,KAAwB,OAA5B,EAAqC;MACnCJ,gBAAgB,CAACK,KAAjB;IACD;;IAGD,IAAMC,sBAAsB,GAAG,8BAAmBf,YAAnB,EAAiC,UAACgB,IAAD,EAAU;MACxE,IAAI,CAACA,IAAD,IAASX,YAAb,EAA2B;QACzBI,gBAAgB,CAACK,KAAjB;MACD;;MACDR,eAAe,CAAC,CAAC,CAACU,IAAH,CAAf;IACD,CAL8B,CAA/B;;IAQA,IAAId,UAAJ,EAAgB;MACdA,UAAU,CAACO,gBAAD,CAAV;IACD;;IAGDA,gBAAgB,CAACQ,KAAjB,CAAuBV,UAAU,CAACW,OAAlC,EAA2CnB,QAA3C;IAEA,OAAO,YAAM;MACXgB,sBAAsB;MACtBN,gBAAgB,CAACK,KAAjB;IACD,CAHD;EAID,CAlCD,EAkCG,CAACX,UAAD,EAAaJ,QAAb,CAlCH;;EAoCA,IAAII,UAAU,KAAK,IAAnB,EAAyB;IAEvBK,OAAO,CAAC,gCAAD,CAAP;EACD;;EAED,OACE;IAAK,SAAS,EAAEP,SAAhB;IAA2B,GAAG,EAAEM;EAAhC,EADF;AAGD,CA/DD;;eAiEeV,Y"}